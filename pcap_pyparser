#!/usr/bin/python

import dpkt
import sys


def parser():
    f = open('test_file.pcap')
    pcap = dpkt.pcap.Reader(f)

#for ts, buf in pcap:
    #print(ts, len(buf))

    for ts, buf in pcap:
        try:
            eth = dpkt.ethernet.Ethernet(buf)
            ip = eth.data
            tcp = ip.data
            print(tcp.dport)
        except AttributeError:
            print('Error!')
            continue


if __name__ == "__main__":
    if len(sys.argv) == 1:
        # If parser run without any parameters:
        print('Usage: {0} <param> [input_filename]').format(sys.argv[0])
        print
        print('Try -h or --help for more help.')
        sys.exit()

    elif len(sys.argv) <= 2:
        # If parser run with one parameter
        if sys.argv[1] == '-h' or sys.argv[1] == '--help':
            # If this parameter is '-h' of '--help' for help
            print('Usage: {0} <param> [input_filename]').format(sys.argv[0])
            print
            print('[input filename] -- enter dir and filename')
            print('')
        else:
            # If this parameter ISN'T '-h' of '--help' for help
            print('Usage: {0} <param> [input_filename]').format(sys.argv[0])
            print
            print('Try -h or --help for more help.')

    else:
        print(sys.argv[1])